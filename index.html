<head>
    <meta charset="UTF-8">
    <title>Home</title>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css" rel="stylesheet" />
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
    <style>
        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        #map {
            width: 100%;
            height: 100vh;
            position: relative;
        }

        .search-container {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            z-index: 1;
        }

        .search-container input {
            width: 300px;
        }

        .menu-container {
            position: absolute;
            top: 70px; /* Adjust this value as needed */
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 1;
        }

        .menu-item {
            position: relative;
            padding: 10px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 5px;
            cursor: pointer;
        }

        .menu-item:hover .dropdown-menu {
            display: block;
        }

        .dropdown-menu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 10px;
            z-index: 2;
        }

        .dropdown-menu label {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .dropdown-menu input[type="checkbox"] {
            margin-right: 5px;
        }
    </style>
    <link href="assets/plugins/custom/prismjs/prismjs.bundle.css" rel="stylesheet" type="text/css">
    <link href="assets/plugins/global/plugins.bundle.css" rel="stylesheet" type="text/css">
    <link href="assets/css/style.bundle.css" rel="stylesheet" type="text/css">
</head>

<body>
    <div id="map">
        <div class="search-container">
            <span class="svg-icon svg-icon-3 svg-icon-gray-500 position-absolute top-50 translate-middle ms-6">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none">
                    <rect opacity="0.5" x="17.0365" y="15.1223" width="8.15546" height="2" rx="1"
                        transform="rotate(45 17.0365 15.1223)" fill="black" />
                    <path
                        d="M11 19C6.55556 19 3 15.4444 3 11C3 6.55556 6.55556 3 11 3C15.4444 3 19 6.55556 19 11C19 15.4444 15.4444 19 11 19ZM11 5C7.53333 5 5 7.53333 5 11C5 14.4667 7.53333 17 11 17C14.4667 17 17 14.4667 17 11C17 7.53333 14.4667 5 11 5Z"
                        fill="black" />
                </svg>
            </span>
            <input type="text" class="form-control form-control-solid ps-10" name="search" value=""
                placeholder="Search" />
            <select class="form-select ms-3" data-control="select" data-placeholder="Select an option">
                <option></option>
                <option value="1">Option 1</option>
                <option value="2">Option 2</option>
            </select>
        </div>
        <div class="menu-container">
            <div class="menu-item">
                A
                <div class="dropdown-menu">
                    <label><input type="checkbox" /> Option 1</label>
                    <label><input type="checkbox" /> Option 2</label>
                    <label><input type="checkbox" /> Option 3</label>
                </div>
            </div>
            <div class="menu-item">
                B
                <div class="dropdown-menu">
                    <label><input type="checkbox" /> Option 1</label>
                    <label><input type="checkbox" /> Option 2</label>
                    <label><input type="checkbox" /> Option 3</label>
                </div>
            </div>
            <div class="menu-item">
                C
                <div class="dropdown-menu">
                    <label><input type="checkbox" /> Option 1</label>
                    <label><input type="checkbox" /> Option 2</label>
                    <label><input type="checkbox" /> Option 3</label>
                </div>
            </div>
            <div class="menu-item">
                D
                <div class="dropdown-menu">
                    <label><input type="checkbox" /> Option 1</label>
                    <label><input type="checkbox" /> Option 2</label>
                    <label><input type="checkbox" /> Option 3</label>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiZ2ljb2RlcmdhbCIsImEiOiJjazcxODNscXYwM3R3M2V0aGcwMWxvcWV0In0.s246-Q7mSmCOOeqwP-HGtA';

    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/dark-v11',
        center: [-96, 37.8],
        zoom: 4.5,
        minZoom: 4.5,
        maxZoom: 15,
        attributionControl: false
    });
    const statesBoundariesUrl = 'https://raw.githubusercontent.com/jgoodall/us-maps/master/geojson/state.geo.json';
    const countiesBoundariesUrl = 'https://raw.githubusercontent.com/joelwolfgang/GEOJson-US-Counties/master/usCounties.geojson';
    const zipcodeUrl = 'https://raw.githubusercontent.com/talentdev0314/zip-code/main/zips-by_county.json';
    const zwsid = 'X1-ZWz1hj5qt65bt7_2kpit';
    const zillowApiUrl = `https://web.zillow.com/webservice/GetDeepSearchResults.htm?zws-id=${zwsid}&`;

    let currentPopup = null;
    let highlightedCityId = null;

    map.on('click', function (e) {

    });
    map.on('load', () => {
        map.addSource('city-borders', {
            type: 'geojson',
            data: countiesBoundariesUrl
        });
        map.addSource('state-borders', {
            type: 'geojson',
            data: statesBoundariesUrl
        });
        map.addLayer({
            id: 'city-borders-layer',
            type: 'fill',
            source: 'city-borders',
            paint: {
                'fill-color': '#00FF47',
                'fill-opacity': 0.3,
                'fill-outline-color': '#000000'
            }
        });
        map.addLayer({
            id: 'state-borders-layer',
            type: 'line',
            source: 'state-borders',
            paint: {
                'line-color': '#000000',
                'line-width': 2
            }
        });

        map.on('mousemove', 'city-borders-layer', async (e) => {
            if (!e.features || e.features.length === 0) {
                return;
            }

            map.getCanvas().style.cursor = 'pointer';
            const cityName = e.features[0].properties.COUNTY_STATE_NAME;
            const geoid = e.features[0].properties.GEOID;
            let homeValue = 'N/A';

            if (currentPopup) {
                currentPopup.remove();
            }
            currentPopup = new mapboxgl.Popup()
                .setLngLat(e.lngLat)
                .setHTML(`
          <strong>${cityName}</strong><br>
          Home Value: ${homeValue}
        `)
                .addTo(map);

            if (highlightedCityId && highlightedCityId !== geoid) {
                map.setPaintProperty('city-borders-layer', 'fill-opacity', 0.3);
            }

            highlightedCityId = geoid;
            map.setPaintProperty('city-borders-layer', 'fill-opacity', [
                'case',
                ['==', ['get', 'GEOID'], highlightedCityId],
                0.6,
                0.3
            ]);
        });
        map.on('mouseleave', 'city-borders-layer', () => {
            map.getCanvas().style.cursor = '';  // Reset cursor
            map.setPaintProperty('city-borders-layer', 'fill-opacity', 0.3);
            if (currentPopup) {
                currentPopup.remove();
                currentPopup = null;
            }
            highlightedCityId = null;
        });
    });

</script>
<script src="assets/plugins/global/plugins.bundle.js"></script>
<script src="assets/js/scripts.bundle.js"></script>
<script src="assets/plugins/custom/prismjs/prismjs.bundle.js"></script>
<script src="assets/js/custom/documentation/forms/select2.js"></script>

</html>